<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nasoro AI</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/tokyo-night-dark.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
body{margin:0;font-family:sans-serif;background:#050505;color:white;height:100vh;display:flex;overflow:hidden;}
#sidebar{width:280px;background:rgba(10,10,10,0.95);backdrop-filter:blur(30px);padding:1rem;overflow-y:auto;}
#main{flex:1;display:flex;flex-direction:column;}
header{background:rgba(5,5,5,0.8);backdrop-filter:blur(20px);padding:1rem;display:flex;justify-content:space-between;align-items:center;}
#chat-container{flex:1;overflow-y:auto;padding:1rem;}
textarea{width:100%;resize:none;padding:.5rem;background:#0f0f0f;color:white;border:none;border-radius:12px;}
button{padding:.5rem 1rem;border:none;border-radius:12px;background:#2f80ed;color:white;cursor:pointer;}
.model-btn{display:flex;justify-content:space-between;padding:.5rem .75rem;margin:.25rem 0;background:#1f1f1f;border-radius:12px;cursor:pointer;}
.model-btn:hover{background:#2f2f2f;}
</style>
</head>
<body>

<div id="sidebar">
  <h2 class="text-xl font-bold mb-4">Nasoro AI</h2>
  <div id="model-list"></div>
</div>

<div id="main">
<header>
  <span>Nasoro</span>
</header>

<div id="chat-container">
  <p class="text-zinc-500">How can I help you?</p>
</div>

<div style="padding:1rem;display:flex;gap:.5rem;align-items:flex-end;">
  <textarea id="chat-field" rows="1" placeholder="Talk with Nasoro..."></textarea>
  <button id="send-btn"><i class="fa-solid fa-arrow-up"></i></button>
</div>
</div>

<script>
const NASORO_TIERS = [
  { name:"1.2 Fast", tier:"Oro-1.2-fast" },
  { name:"1.2 Pro", tier:"Oro-1.2-pro" },
  { name:"2 Fast", tier:"Oro-2-fast" },
  { name:"2 Pro", tier:"Oro-2-pro" },
  { name:"2 Chat Oro", tier:"Oro-2-chat" }
];

let selectedTier = NASORO_TIERS[0].tier;

const modelList = document.getElementById('model-list');
NASORO_TIERS.forEach(m => {
  const div = document.createElement('div');
  div.className = 'model-btn';
  div.textContent = m.name;
  div.onclick = () => selectedTier = m.tier;
  modelList.appendChild(div);
});

const chatContainer = document.getElementById('chat-container');
const chatField = document.getElementById('chat-field');
const sendBtn = document.getElementById('send-btn');

function postMessage(msg, role='user') {
  const div = document.createElement('div');
  div.style.margin = '0.5rem 0';
  div.innerHTML = `<strong>${role==='nasoro'?'Nasoro':'You'}:</strong> ${msg}`;
  chatContainer.appendChild(div);
  chatContainer.scrollTop = chatContainer.scrollHeight;
}

async function sendMessage() {
  const msg = chatField.value.trim();
  if(!msg) return;
  postMessage(msg,'user');
  chatField.value='';
  try {
    const res = await fetch('/ai', {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ message: msg, tier: selectedTier, system_prompt:"You are Nasoro AI. A chill multimodal AI made by Nas9229alt." })
    });
    const data = await res.json();
    postMessage(data.reply || "Thinking...",'nasoro');
  } catch(e) {
    postMessage("Error connecting to backend.",'nasoro');
  }
}

sendBtn.addEventListener('click', sendMessage);
chatField.addEventListener('keydown', e => {
  if(e.key === 'Enter' && !e.shiftKey){ e.preventDefault(); sendMessage(); }
});
</script>

</body>
</html>
